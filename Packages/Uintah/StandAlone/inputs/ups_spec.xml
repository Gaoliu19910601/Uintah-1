
<!--
   UPS_SPEC:
     This specification defines the valid tags, their attributes, and
     their values.  

   DTD/XML Schema:

     This file is similar to a DTD or an XML Schema, however we didn't
     use either of these approaches for the following reasons: DTD's
     do not (easily) allow you to have optional Tags and Tags that may
     appear in any order.  They also don't do (minimal) validation of
     the type of data in each tag.  XML Schema may actually allow for
     some or all of this type of validation, however, we don't have an
     XML library capable of using XML Schema (as libxml2 (the lib we
     use) doesn't (yet?) support it.  We could have tried using
     another XML library (off-line), such as Xerces, but we wanted the
     validation to take place as the code begins to execute.

   Format of this specification:

     spec: need  type  validValues

       need: OPTIONAL, REQUIRED, MULTIPLE   (Probably need MULTIPLE-REQ and MULTIPLE-OPT.
                                             Currently MULTIPLE means 0 or more...)
       type: DOUBLE, INTEGER, STRING, VECTOR, NONE (NONE means the tag doesn't have any
                                                    data (text) but can have attributes and/or
                                                    sub-tags.)

       validValues is a _single_ string (see below for how it is parsed) that contains valid values
       or the value of the tag.  The specification of valid values depends on the type of the tag:
  
         STRING: a comma separated lists of strings which enumerate
                 explicitly which values the string can take on. If 
                 valid values for a string are not provided, then
                 all strings will be accepted.
         INTEGER/DOUBLE: "positive" = a positive value, "num, num" =
                 min, max values.  If not specified, then any
                 integer/double will be accepted.
               
         VECTOR: not quite sure how to specify valid values for a
         vector yet...

       Probably need a way to specify that if one tag exists, then
       another is not valid... perhaps we need a few more of these type
       of things too.  Let me know if you run into cases like this
       that should be enumerated so that they can be validated.
-->


<Uintah_specification> 

  <Meta                 spec="OPTIONAL NONE">
    <title              spec="OPTIONAL STRING" />
  </Meta>

  <Time                 spec="REQUIRED NONE">
    <maxTime            spec="REQUIRED DOUBLE  'positive'" />
    <maxTimesteps       spec="OPTIONAL INTEGER 'positive'" />
    <initTime           spec="REQUIRED DOUBLE  'positive'" />
    <deltMin            spec="REQUIRED DOUBLE  '0.0000001, 1000'" />
    <deltMax            spec="REQUIRED DOUBLE  '0.0000001, 1000'" />
    <deltInit           spec="OPTIONAL DOUBLE  'positive'" />
    <maxDeltIncrease    spec="OPTIONAL DOUBLE  'positive'" />
    <maxInitialDelt     spec="OPTIONAL DOUBLE  'positive'" />
    <timestepMultiplier spec="REQUIRED DOUBLE  'positive'" />
  </Time>

  <SimulationComponent  spec="OPTIONAL NONE"> <!-- FIXME: is this really optional? -->
    <type               spec="REQUIRED STRING 'mpm, arches, ice, mpmice, mpmarches, impm'" />
  </SimulationComponent>

  <DataArchiver         spec="REQUIRED NONE">
      <filebase         spec="REQUIRED STRING" />
      <outputTimestepInterval spec="REQUIRED INTEGER 'positive'" />
      <save             spec="MULTIPLE NONE"
                        attribute1="side      REQUIRED STRING 'x-, x+, y-, y+, z-, z+'"
                        attribute2="label     REQUIRED STRING 'press_equil_CC, vol_frac_CC,
                                                               sp_vol_CC, uvel_FC, vvel_FC,
                                                               wvel_FC, uvel_FCME, vvel_FCME,
                                                               wvel_FCME, delP_Dilatate, press_CC,
                                                               mom_L_ME_CC, vel_CC, rho_CC, temp_CC,
                                                               KineticEnergy, TotalIntEng'" />
      <!-- ???? IS checkpoint REALLY OPTIONAL???? -->
      <checkpoint       spec="OPTIONAL NONE"
                        attribute1="interval  REQUIRED DOUBLE  'positive'"
                        attribute2="cycle     REQUIRED INTEGER 'positive'" />
      <outputDoubleAsFloat spec="OPTIONAL NONE" />
      <compression         spec="OPTIONAL STRING 'gzip'" />
  </DataArchiver>

  <Debug                spec="OPTIONAL NONE" >
    <dbg_timeStart      spec="REQUIRED DOUBLE" />
    <dbg_timeStop       spec="REQUIRED DOUBLE" />
    <dbg_outputInterval spec="REQUIRED DOUBLE" />
    <dbg_BeginIndex     spec="REQUIRED STRING" /> <!-- FIXME: HOW TO HANDLE VALUES LIKE: [[0,0,0]] -->
    <dbg_EndIndex       spec="REQUIRED STRING" /> <!-- FIXME: HOW TO HANDLE VALUES LIKE: [[0,0,0]] -->
    <dbg_Matls          spec="REQUIRED STRING" /> <!-- FIXME: HOW TO HANDLE VALUES LIKE: [0,1] -->
    <dbg_SigFigs        spec="OPTIONAL INTEGER '1, 20'" />
    <debug              spec="MULTIPLE NONE"
                        attribute1="label REQUIRED STRING 'switchTestConservation_abc, switchDebug_explicit_press, switchDebug_LagrangianValues,
                                                           switchDebug_MomentumExchange_CC, switchDebug_Initialize, switchDebug_equil_press,
                                                           switchDebug_vel_FC, switchDebug_explicit_press, switchDebug_PressFC,
                                                           switchDebug_LagrangianValues, switchDebug_MomentumExchange_CC,
                                                           switchDebug_Source_Sink, switchDebug_advance_advect'" />
  </Debug>

  <InitialConditions    spec="OPTIONAL NONE">
    <MPM                spec="OPTIONAL NONE" />
    <ARCHES             spec="OPTIONAL NONE" />
  </InitialConditions>

  <Grid                 spec="REQUIRED NONE">

    <BoundaryConditions spec="REQUIRED NONE">
      <Face             spec="MULTIPLE NONE"
                        attribute1="side      REQUIRED STRING 'x-, x+, y-, y+, z-, z+'">
        <BCType         spec="MULTIPLE NONE"
                        attribute1="id        REQUIRED STRING 'all'"
                        attribute2="var       REQUIRED STRING 'Dirichlet, symmetry'"
                        attribute3="label     REQUIRED STRING 'Pressure, Velocity, Temperature, Density, Symmetric'" >
          <value        spec="OPTIONAL STRING" /> <!-- ERROR... it is required for some, but not for Dirichlet!!!
                                                       also, type can be different for different labels... how to handle? --> 
        </BCType>
      </Face>
    </BoundaryConditions>

    <Level              spec="REQUIRED NONE">
      <Box              spec="REQUIRED NONE"
                        attribute1="label     REQUIRED STRING">
        <lower          spec="REQUIRED VECTOR" />
        <upper          spec="REQUIRED VECTOR" />
        <resolution     spec="OPTIONAL VECTOR" />
        <patches        spec="REQUIRED VECTOR" />
        <extraCells     spec="REQUIRED VECTOR" />
      </Box>
      <spacing          spec="OPTIONAL VECTOR" /> <!-- ????????? -->
    </Level>

  </Grid>

  <PhysicalConstants    spec="REQUIRED NONE">
    <gravity            spec="REQUIRED VECTOR" />
    <reference_pressure spec="OPTIONAL DOUBLE" />
  </PhysicalConstants>

  <CFD                  spec="OPTIONAL NONE" >
    <cfl                spec="REQUIRED INTEGER 'positive'" />
    <ICE                spec="REQUIRED NONE" >
      <advection        spec="REQUIRED NONE" 
                        attribute1="type REQUIRED STRING 'FirstOrder'" />
    </ICE>        
  </CFD>

  <Scheduler              spec="OPTIONAL NONE">
    <VarTracker           spec="REQUIRED NONE">
      <start_time         spec="REQUIRED DOUBLE" />
      <end_time           spec="REQUIRED DOUBLE" />
      <start_index        spec="REQUIRED VECTOR" />
      <end_index          spec="REQUIRED VECTOR" />
      <var                spec="MULTIPLE NONE"
                          attribute1="label REQUIRED STRING"
                          attribute2="dw    REQUIRED STRING 'NewDW, OldDW'" />
    </VarTracker>
  </Scheduler>

  <MPM                    spec="OPTIONAL NONE">
    <time_integrator      spec="REQUIRED STRING 'explicit'" />
    <interpolator         spec="REQUIRED STRING 'gimp'" />
  </MPM>

  <MaterialProperties        spec="OPTIONAL NONE">
    <MPM                     spec="OPTIONAL NONE">
      <material              spec="REQUIRED NONE">
        <density             spec="REQUIRED DOUBLE" />
        <constitutive_model  spec="REQUIRED NONE"
                             attribute1="type    REQUIRED STRING 'comp_mooney_rivlinnnnqwerty'" >
          <he_constant_1     spec="REQUIRED DOUBLE 'positive'" />
          <he_constant_2     spec="REQUIRED DOUBLE 'positive'" />
          <he_PR             spec="REQUIRED DOUBLE 'positive'" />
        </constitutive_model>
        <thermal_conductivity spec="REQUIRED DOUBLE 'positive'" />
        <specific_heat        spec="REQUIRED DOUBLE 'positive'" />
        <geom_object          spec="MULTIPLE NONE" >
          <cylinder           spec="REQUIRED NONE"
                              attribute1="label    REQUIRED STRING" >
            <bottom           spec="REQUIRED VECTOR" />
            <top              spec="REQUIRED VECTOR" />
            <radius           spec="REQUIRED DOUBLE 'positive2'" />
          </cylinder>
          <res                spec="REQUIRED VECTOR" />
          <velocity           spec="REQUIRED VECTOR" />
          <temperature        spec="REQUIRED DOUBLE" />
        </geom_object>
      </material>
      <contact                spec="REQUIRED NONE" >
        <type                 spec="REQUIRED STRING 'null'" />
        <materials            spec="REQUIRED STRING" /> <!-- THIS IS WRONG.  What is [0]? -->
      </contact>
    </MPM>

    <ICE                      spec="OPTIONAL NONE" > 
      <material               spec="MULTIPLE NONE"
                              attribute1="name REQUIRED STRING" >
        <EOS                  spec="REQUIRED NONE"
                              attribute1="type REQUIRED STRING 'ideal_gas'" />
        <dynamic_viscosity    spec="REQUIRED DOUBLE 'positive'" />
        <thermal_conductivity spec="REQUIRED DOUBLE 'positive'" />
        <specific_heat        spec="REQUIRED DOUBLE 'positive'" />
        <gamma                spec="REQUIRED DOUBLE 'positive'" />

        <geom_object          spec="MULTIPLE NONE" >
          <cylinder           spec="OPTIONAL NONE"
                              attribute1="label    REQUIRED STRING" >
            <bottom           spec="REQUIRED VECTOR" />
            <top              spec="REQUIRED VECTOR" />
            <radius           spec="REQUIRED DOUBLE 'positive2'" />
          </cylinder>

          <box                spec="OPTIONAL NONE"
                              attribute1="label    REQUIRED STRING" />

          <difference         spec="OPTIONAL NONE" >
            <box              spec="MULTIPLE NONE"
                              attribute1="label REQUIRED STRING" >
              <min            spec="REQUIRED VECTOR" />
              <max            spec="REQUIRED VECTOR" />
            </box>
          </difference>

          <res                spec="REQUIRED VECTOR" />
          <velocity           spec="REQUIRED VECTOR" />
          <temperature        spec="REQUIRED DOUBLE" />
          <density            spec="REQUIRED DOUBLE" />
          <pressure           spec="REQUIRED DOUBLE" />

        </geom_object>
      </material>
    </ICE>

    <exchange_properties      spec="OPTIONAL NONE" >
      <exchange_coefficients  spec="REQUIRED NONE" >
        <momentum             spec="REQUIRED STRING" /> <!-- FIXME: not string, HOW TO HANDLE [1.0,1.0] -->
        <heat                 spec="REQUIRED STRING" /> <!-- FIXME: not string, HOW TO HANDLE [1.0,1.0] -->
      </exchange_coefficients>
    </exchange_properties>

  </MaterialProperties>

  <Models                     spec="OPTIONAL NONE" >
    <Model                    spec="REQUIRED NONE"
                              attribute1="type REQUIRED STRING" >
      <fromMaterial           spec="REQUIRED STRING 'source'" />
      <toMaterial             spec="REQUIRED STRING 'destination'" />
      <rate                   spec="REQUIRED DOUBLE" />
    </Model>
  </Models>

</Uintah_specification>
