<?xml version='1.0' encoding='ISO-8859-1' ?>
<!-- <!DOCTYPE Uintah_specification SYSTEM "input.dtd"> -->
<!-- Unit:
     lenght = nm
     density = atoms/nm^3
     diffusivity = nm^2/us
-->

<Uintah_specification>

   <Meta>
       <title>FVM Solution of PNP - Test 1</title>
   </Meta>

   <SimulationComponent type="mpnp" />

   <Time>
     <maxTime>0.1</maxTime>                          
     <initTime>0.0</initTime>                        
     <delt_min>1.0e-10</delt_min>                    
     <delt_max>1.0e-10</delt_max>                          
     <timestep_multiplier>1</timestep_multiplier>    
     <max_Timesteps> 10 </max_Timesteps>
   </Time>
   
   <DataArchiver>
     <filebase>pnp_test1.uda</filebase>                   
     <outputTimestepInterval>1</outputTimestepInterval>    
     <!--
     -->
     <save label = "cc.esPotential"/>                            
     <save label = "cc.rhsEsPotential"/>                            
     <save label = "cc.PosCharge"/>
     <save label = "cc.NegCharge"/>                            
     <save label = "cc.RelativePermittivity"/>                            
     <save label = "cc.MatId"/>                            
     <save label = "cc.InterfaceCell"/>                            
     <save label = "cc.GridPermittivity"/>                            
     <save label = "cc.GridTotalCharge"/>                            
     <checkpoint cycle = "2" interval = ".01"/>            
   </DataArchiver>

   <Grid>
     <Level>                                          
       <Box label = "1">                                
         <lower>      [  0.0,   0.0, 0.0] </lower>               
         <upper>      [130.0, 115.0, 1.0] </upper>               
         <resolution> [130,   115,   1]  </resolution> 
         <extraCells> [1,1,1]       </extraCells>
         <patches>    [1,1,1]       </patches>             
       </Box>                                           
     </Level>                                         
     <BoundaryConditions>
       <Face side = "x-">
         <BCType id = "all" label = "Voltage" var = "Neumann">
                <value> 0.0 </value>
         </BCType>
         <BCType id = "all" label = "PosCharge" var = "Neumann">
                <value> 0.0 </value>
         </BCType>
         <BCType id = "all" label = "NegCharge" var = "Neumann">
                <value> 0.0 </value>
         </BCType>
       </Face>
       <Face side = "x+">
         <BCType id = "all" label = "Voltage" var = "Neumann">
                <value> 0.0 </value>
         </BCType>
         <BCType id = "all" label = "PosCharge" var = "Neumann">
                <value> 0.0 </value>
         </BCType>
         <BCType id = "all" label = "NegCharge" var = "Neumann">
                <value> 0.0 </value>
         </BCType>
       </Face>
       <Face side = "y-">
         <BCType id = "all" label = "Voltage" var = "Dirichlet">
                <value> -1.0 </value>
         </BCType>
         <BCType id = "all" label = "PosCharge" var = "Neumann">
                <value> 0.0 </value>
         </BCType>
         <BCType id = "all" label = "NegCharge" var = "Neumann">
                <value> 0.0 </value>
         </BCType>
       </Face>                  
       <Face side = "y+">
         <BCType id = "all" label = "Voltage" var = "Dirichlet">
                <value> 1.0 </value>
         </BCType>
         <BCType id = "all" label = "PosCharge" var = "Neumann">
                <value> 0.0 </value>
         </BCType>
         <BCType id = "all" label = "NegCharge" var = "Neumann">
                <value> 0.0 </value>
         </BCType>
       </Face>
       <Face side = "z-">
         <BCType id = "all" label = "Voltage" var = "Neumann">
                <value> 0.0 </value>
         </BCType>
         <BCType id = "all" label = "PosCharge" var = "Neumann">
                <value> 0.0 </value>
         </BCType>
         <BCType id = "all" label = "NegCharge" var = "Neumann">
                <value> 0.0 </value>
         </BCType>
       </Face>                  
       <Face side = "z+">
         <BCType id = "all" label = "Voltage" var = "Neumann">
                <value> 0.0 </value>
         </BCType>
         <BCType id = "all" label = "PosCharge" var = "Neumann">
                <value> 0.0 </value>
         </BCType>
         <BCType id = "all" label = "NegCharge" var = "Neumann">
                <value> 0.0 </value>
         </BCType>
        </Face>
     </BoundaryConditions>
   </Grid>

   <Solver type = "hypre" />

   <MaterialProperties>
     <FVM>
       <material name="neg_electrode">
         <diffusivity>0.0</diffusivity>
         <geom_object>
           <box label="box_neg_elec">
             <min> [ 45.0,  0.0, 0.0 ] </min>
             <max> [ 85.0, 50.0, 1.0 ] </max>
             <!--
             <min> [  0.0, 45.0, 0.0 ] </min>
             <max> [ 85.0, 75.0, 1.0 ] </max>
             -->
           </box>
           <pos_charge_density> 1.0  </pos_charge_density>
           <neg_charge_density> 1.0  </neg_charge_density>
           <rel_permittivity> 3.0 </rel_permittivity>
         </geom_object>
       </material>
       <material name="electrolyte">
         <diffusivity>1.9e3</diffusivity>
         <geom_object>
           <difference>
             <box label="whole_domain">
               <min> [   0.0,   0.0, 0.0 ]       </min>
               <max> [ 130.0, 115.0, 1.0 ]       </max>
             </box>
             <box label="box_neg_elec"/>
           </difference>
           <pos_charge_density> 0.6  </pos_charge_density>
           <neg_charge_density> 0.6  </neg_charge_density>
           <rel_permittivity> 88.0 </rel_permittivity>
         </geom_object>
       </material>
     </FVM>
   </MaterialProperties>           

   <FVM>
     <unit_charge>      1.602e-19 </unit_charge>
     <permittivity>     8.85e-21  </permittivity>
     <boltzmanns_const> 1.38e-23  </boltzmanns_const>
     <temperature>      300       </temperature>
     <delt>1e-10</delt>
     <Parameters variable="electrostatic_solver">
       <!-- CGSolver options -->
       <norm>     LInfinity  </norm>
       <criteria> Absolute   </criteria>

       <!-- Hypre options -->
       <solver>         cg  </solver>
       <preconditioner> pfmg    </preconditioner>
       <tolerance>      1.e-9  </tolerance>
       <maxiterations>  7500    </maxiterations>
       <npre>           1       </npre>
       <npost>          1       </npost>
       <skip>           0       </skip>
       <jump>           0       </jump>
       <setupFrequency> 3       </setupFrequency>
     </Parameters>
   </FVM> 
</Uintah_specification>

