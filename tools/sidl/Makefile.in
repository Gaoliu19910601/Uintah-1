SRCTOP  = @top_srcdir@
SRCDIR  = @srcdir@
OBJTOP  = ../..

SRCS      = Spec.cc SymbolTable.cc emit.cc main.cc parser.y scanner.l \
		static_check.cc
LIBRARIES = @LEXLIB@
SRCTOP_ABS    = $(shell cd $(SRCTOP) ; pwd)
SIDL_BUILTINS = $(SRCTOP_ABS)/Component/CIA/

CFLAGS := $(CFLAGS) -DSIDL_BUILTINS=\"$(SIDL_BUILTINS)\"
INCLUDES  = -I$(SRCTOP) -I$(SRCTOP)
            
PROGRAM   = sidl
LEX = lex -t
YACC = @YACC@ -d -v

include $(SRCTOP)/scripts/program.mk

scanner.cc: scanner.l
	$(LEX) scanner.l > scanner.cc

scanner.o: parser.h

parser.cc parser.h: parser.y
	$(YACC) -d parser.y
	sed 's/getenv()/xxgetenv()/g' < y.tab.c > parser.cc
	rm y.tab.c
	mv y.tab.h parser.h
