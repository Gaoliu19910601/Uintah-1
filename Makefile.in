SRCTOP  = @top_srcdir@
SRCDIR  = @srcdir@
OBJTOP  = .

ifeq (@BUILD_PARALLEL@,yes)
COMPONENT_DIRS = tools/sidl Component
endif

SUBDIRS = SCICore $(COMPONENT_DIRS) PSECore main PSECommon \
	  testprograms @PACKAGE_DIRS@

all:: sci_config.h

include $(OBJTOP)/scripts/recurse.mk

_cleanHere::
	rm -f uintah scirun davew

_distcleanHere::
	rm -f config.h so_locations
	rm -f scripts/cc scripts/CC
	rm -f scripts/compile.mk scripts/targets.mk
	rm -f config.cache config.log config.status

ifeq (,$(findstring reportObjs,$(MAKECMDGOALS)))
ifeq (,$(findstring clean,$(MAKECMDGOALS)))
${SRCDIR}/configure: ${SRCDIR}/configure.in ${SRCDIR}/scripts/aclocal.m4
	cd ${SRCDIR} && autoconf
endif
endif

sci_config.h: stamp-h
stamp-h: ${SRCTOP}/sci_config.h.in ${SRCTOP}/sci_defs.h.in \
		${OBJTOP}/config.status \
		${SRCTOP}/scripts/cc.in \
		${SRCTOP}/scripts/compile.mk.in \
		${SRCTOP}/scripts/recurse.mk.in \
		${SRCTOP}/scripts/targets.mk.in
	./config.status
     
config.status: ${SRCDIR}/configure
	./config.status --recheck
	./config.status
