
/*______________________________________________________________________
*   This file contains all of the debugging and ploting code for all of the
*   functions.
*   main.c
*_______________________________________________________________________*/
#if switchInclude_main_1
    /*__________________________________
    * Define plotting variables 
    *___________________________________*/
    plot_type           = 1;
    Number_sub_plots    = 4;
    strcpy(file_basename,"");
    outputfile_type     = 0;
    x_axis_origin       = GC_LO(xLoLimit);
    y_axis_origin       = GC_LO(yLoLimit);
    x_axis              = GC_HI(xHiLimit);
    y_axis              = GC_HI(yHiLimit);
    outline_ghostcells  = 1;
    strcpy(x_label,"cell\0");
    strcpy(y_label,"cell\0");
    
    for (m = 1; m <= nMaterials; m++)
    {        
        /* ______________________________
        *  Variable 1
        *__________________________________*/  
        sprintf(graph_label, "Main Program INPUTS rho_CC, Mat. %d \0",m);                   
        data_array1    = convert_darray_4d_to_vector(
                                rho_CC,
                                GC_LO(xLoLimit),       GC_HI(xHiLimit),           GC_LO(yLoLimit),
                                GC_HI(yHiLimit),       (zLoLimit),                (zHiLimit),
                                m,               m,
                                &max_len); 
        PLOT;

        free_vector(    data_array1,       1, max_len);
        /*__________________________________
        *   Variable 2
        *___________________________________*/ 
        sprintf(graph_label, "Main Program INPUTS TEMP_CC, Mat. %d \0",m);         
        data_array1    = convert_darray_4d_to_vector(
                                Temp_CC,
                                GC_LO(xLoLimit),       GC_HI(xHiLimit),           GC_LO(yLoLimit),
                                GC_HI(yHiLimit),       (zLoLimit),                (zHiLimit),
                                m,               m,
                                &max_len); 
        PLOT;
         free_vector(    data_array1,       1, max_len);
        /*__________________________________
        *   Variable 3
        *___________________________________*/         
        sprintf(graph_label, "Main Program INPUTS uvel_CC, Mat. %d \0",m); 
        data_array1    = convert_darray_4d_to_vector(
                                uvel_CC,
                                GC_LO(xLoLimit),       GC_HI(xHiLimit),           GC_LO(yLoLimit),
                                GC_HI(yHiLimit),       (zLoLimit),                 (zHiLimit),
                                m,               m,
                                &max_len); 
        PLOT;
         free_vector(    data_array1,       1, max_len); 
        /*__________________________________
        *   Variable 4
        *___________________________________*/         
        sprintf(graph_label, "Main Program INPUTS vvel_CC, Mat. %d \0",m); 
        data_array1    = convert_darray_4d_to_vector(
                                vvel_CC,
                                GC_LO(xLoLimit),       GC_HI(xHiLimit),           GC_LO(yLoLimit),
                                GC_HI(yHiLimit),       (zLoLimit),                 (zHiLimit),
                                m,               m,
                                &max_len); 
        PLOT;
         free_vector(    data_array1,       1, max_len);                              
        /*__________________________________
        *  Clean up the plotting windows
        *___________________________________*/ 
        fprintf(stderr, "Material %i, Press return to continue\n", m);
        getchar();
    }
         
#endif


/*______________________________________________________________________
*   BOTTOM OF MAIN
*_______________________________________________________________________*/

#if switchInclude_main
    
    #if (switchDebug_main == 2)
    for (m = 1; m <= nMaterials; m++)
    {   
        fprintf(stderr"\tMaterial %i \n",m);
        printData_4d(   xLoLimit,       yLoLimit,       zLoLimit,
                        xHiLimit,       yHiLimit,       zHiLimit,
                        m,              m,
                       "Main.c",        "Vol_L_CC",     Vol_L_CC); 
 
         printData_4d(   xLoLimit,      yLoLimit,       zLoLimit,
                        xHiLimit,       yHiLimit,       zHiLimit,
                        m,              m,
                       "Main.c",        "rho_CC",       rho_CC); 
                                             
        printData_4d(   xLoLimit,       yLoLimit,       zLoLimit,
                        xHiLimit,       yHiLimit,       zHiLimit,
                        m,              m,
                       "Main.c",        "Temp_CC",       Temp_CC); 
                       
        printData_4d(   xLoLimit,       yLoLimit,       zLoLimit,
                        xHiLimit,       yHiLimit,       zHiLimit,
                        m,              m,
                       "Main.c",        "uvel_CC",       uvel_CC); 
                       
        printData_4d(   xLoLimit,       yLoLimit,       zLoLimit,
                        xHiLimit,       yHiLimit,       zHiLimit,
                        m,              m,
                       "Main.c",        "vvel_CC",       vvel_CC); 
                       
        printData_4d(   xLoLimit,       yLoLimit,       zLoLimit,
                        xHiLimit,       yHiLimit,       zHiLimit,
                        m,              m,
                       "Main.c",        "xmom_CC",       xmom_CC); 

        printData_4d(   xLoLimit,       yLoLimit,       zLoLimit,
                        xHiLimit,       yHiLimit,       zHiLimit,
                        m,              m,
                       "Main.c",        "ymom_CC",       xmom_CC); 
                         
        printData_4d(   xLoLimit,       yLoLimit,       zLoLimit,
                        xHiLimit,       yHiLimit,       zHiLimit,
                        m,              m,
                       "Main.c",        "delPress_CC",  delPress_CC);   
                       
        printData_4d(   xLoLimit,       yLoLimit,       zLoLimit,
                        xHiLimit,       yHiLimit,       zHiLimit,
                        m,              m,
                       "Main.c",        "Press_CC",  delPress_CC); 
    }  
    #endif
    #if (switchDebug_main == 1)           
       /*__________________________________
        * Define plotting variables 
        *___________________________________*/
        plot_type           = 1;
        Number_sub_plots    = 4;
        strcpy(file_basename,"");
        outputfile_type     = 0;
        x_axis_origin       = (xLoLimit);
        y_axis_origin       = (yLoLimit);
        x_axis              = (xHiLimit);
        y_axis              = (yHiLimit);
        outline_ghostcells  = 0;
        strcpy(x_label,"cell\0");
        strcpy(y_label,"cell\0");                       
/*__________________________________
*   MAIN WINDOW 1
*___________________________________*/   
/*     for (m = 1; m <= nMaterials; m++)
    {           
        sprintf(graph_label, "Main Program vol_L_CC, Mat. %d \0",m);
        plot_type           = 1;
        Number_sub_plots    = 0;
        data_array1    = convert_darray_4d_to_vector(
                                Vol_L_CC,
                                (xLoLimit),       (xHiLimit),       (yLoLimit),
                                (yHiLimit),       (zLoLimit),       (zHiLimit),
                                m,                      m,
                                &max_len); 
        PLOT;
         free_vector(    data_array1,       1, max_len); 
    }          */
    
    
    cpgqndt(&j);
    fprintf(stderr,"Number of available devices %i\n",j);
/*__________________________________
*   MAIN WINDOW 2
*___________________________________*/
    for (m = 1; m <= nMaterials; m++)
    {   
        x_axis_origin       = GC_LO(xLoLimit);
        y_axis_origin       = GC_LO(yLoLimit);
        x_axis              = GC_HI(xHiLimit);
        y_axis              = GC_HI(yHiLimit); 
        plot_type           = 1;
        Number_sub_plots    = 4;
        outline_ghostcells  = 1;        
        /* ______________________________
        *  convert the multidimensional arrays 
        *   into a float vector
        *__________________________________*/ 
        sprintf(graph_label, "Main Program rho_CC, Mat. %d \0",m);                   
        data_array1    = convert_darray_4d_to_vector(
                                rho_CC,
                                GC_LO(xLoLimit),       GC_HI(xHiLimit),  GC_LO(yLoLimit),
                                GC_HI(yHiLimit),       (zLoLimit),       (zHiLimit),
                                m,               m,
                                &max_len);
        PLOT;
        free_vector(    data_array1,       1, max_len);
        
        /*__________________________________
        *   Variable 2
        *___________________________________*/
        sprintf(graph_label, "Main Program Temp_CC, Mat. %d \0",m);
        data_array1    = convert_darray_4d_to_vector(
                                Temp_CC,
                                GC_LO(xLoLimit),       GC_HI(xHiLimit),  GC_LO(yLoLimit),
                                GC_HI(yHiLimit),       (zLoLimit),      (zHiLimit),
                                m,               m,
                                &max_len);
        PLOT;
         free_vector(    data_array1,       1, max_len);

        /*__________________________________
        *   Variable 3
        *___________________________________*/
        sprintf(graph_label, "Main Program uvel_CC, Mat. %d \0",m);
        data_array1    = convert_darray_4d_to_vector(
                                uvel_CC,
                                GC_LO(xLoLimit),       GC_HI(xHiLimit),  GC_LO(yLoLimit),
                                GC_HI(yHiLimit),       (zLoLimit),      (zHiLimit),
                                m,               m,
                                &max_len); 
        PLOT;
         free_vector(    data_array1,       1, max_len);
               
        /*__________________________________
        *   Variable 4
        *___________________________________*/         
        sprintf(graph_label, "Main Program vvel_CC, Mat. %d \0",m);
        data_array1    = convert_darray_4d_to_vector(
                                vvel_CC,
                                GC_LO(xLoLimit),       GC_HI(xHiLimit), GC_LO(yLoLimit),
                                GC_HI(yHiLimit),       (zLoLimit),      (zHiLimit),
                                m,               m,
                                &max_len); 
        PLOT;
         free_vector(    data_array1,       1, max_len); 
         
        if(first_pass == 0)
        {
            fprintf(stderr, "Press return to continue\n");
            getchar();
        }         
         
    }                        
/*__________________________________
*   MAIN WINDOW 3
*___________________________________*/
    for (m = 1; m <= nMaterials; m++)
    {          
        /*__________________________________
        * Define plotting variables 
        *___________________________________*/
        plot_type           = 1;
        Number_sub_plots    = 4;  
        sprintf(graph_label, "Main Program xmom_CC, Mat. %d \0",m);                
        data_array1    = convert_darray_4d_to_vector(
                                xmom_CC,
                                GC_LO(xLoLimit),       GC_HI(xHiLimit),  GC_LO(yLoLimit),
                                GC_HI(yHiLimit),       (zLoLimit),       (zHiLimit),
                                m,                      m,
                                &max_len);
        PLOT;

        free_vector(    data_array1,       1, max_len);
    /*__________________________________
    *   Variable 2
    *___________________________________*/
        sprintf(graph_label, "Main Program ymom_CC, Mat. %d \0",m);
        data_array1    = convert_darray_4d_to_vector(
                                ymom_CC,
                                GC_LO(xLoLimit),       GC_HI(xHiLimit),  GC_LO(yLoLimit),
                                GC_HI(yHiLimit),       (zLoLimit),       (zHiLimit),
                                m,                      m,
                                &max_len);
        PLOT;
         free_vector(    data_array1,       1, max_len);
    /*__________________________________
    *   Variable 3
    *___________________________________*/
        sprintf(graph_label, "Main Program delPress_CC, Mat. %d \0",m);
        data_array1    = convert_darray_4d_to_vector(
                                delPress_CC,
                                GC_LO(xLoLimit),       GC_HI(xHiLimit),  GC_LO(yLoLimit),
                                GC_HI(yHiLimit),       (zLoLimit),        (zHiLimit),
                                m,                      m,
                                &max_len);
        PLOT;
         free_vector(    data_array1,       1, max_len);
    /*__________________________________
    *   Variable 4
    *___________________________________*/
        sprintf(graph_label, "Main Program press_CC, Mat. %d \0",m);
        data_array1    = convert_darray_4d_to_vector(
                                press_CC,
                                GC_LO(xLoLimit),       GC_HI(xHiLimit),  GC_LO(yLoLimit),
                                GC_HI(yHiLimit),       (zLoLimit),        (zHiLimit),
                                m,                      m,
                                &max_len); 
        PLOT;
         free_vector(    data_array1,       1, max_len); 
        if(first_pass == 0)
        {
            fprintf(stderr, "Press return to continue\n");
            getchar();
        } 
    }
                                     
/*__________________________________
*   MAIN WINDOW 4
*___________________________________*/ 
    /*__________________________________
    *   Face centered variables
    *___________________________________*/  
    for (m = 1; m <= nMaterials; m++)
    {         
        Number_sub_plots    = 3;
        sprintf(graph_label, "Main Program uvel_FC, Mat. %d \0",m);
        plot_face_centered_data(
                                GC_LO(xLoLimit),        GC_HI(xHiLimit),    GC_LO(yLoLimit),
                                GC_HI(yHiLimit),        (zLoLimit),         (zHiLimit),
                                delX,                   delY,               uvel_FC,
                                x_label,                y_label,            graph_label,
                                outline_ghostcells,     Number_sub_plots,    
